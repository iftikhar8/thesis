#A quantitative & reproducible approach for biophysical connectivity models
Steven Hawes^1,2^ and Will Figueira^1,2^  
1 University of Sydney, School of Life & Environmental Sciences (Sydney, NSW,  (Australia); 2 Sydney Institute of Marine Science,  (Mosman, NSW,  (Australia)

  
##Abstract 

Biophysical models are an increasingly popular tool in studying marine population connectivity. These models offer the ability to perform analyses of connectivity patterns over temporal and spatial scales that are not possible with empirical techniques. In addition, biophysical models allow for the investigation of the early-life history traits of marine species that influence connectivity. In order to synthesise what parameters were important in biophysical models and how these parameters effected connectivity patterns, we conducted a review of 59 recent studies (published between 2010-2015). However, it was difficult to perform a meta-analysis due to two factors; 1) there was a general inconsistency in reporting of response metrics from these models; and 2) there was a lack of transparency in the values of parameters used as input to these models, creating a lack of reproducibility. to overcome this, we have suggested both a common approach to the metrics that are reported and a list of parameters to biophysical connectivity studies that are essential for reproducibility. We feel having a consistent approach will allow us to mature the field and encourage greater confidence in connectivity studies. This is important as connectivity studies become drivers of management decisions such as designing marine protected areas.

##Introduction
Biophysical models (also known as coupled physical-biological models) have become a popular tool in advancing our understanding of the connectivity patterns of various marine species {SanvicenteAnorve:2014bl}{Koeck:2015bf}{Andrello:2014ge}. These models are not a new technique, biophysical models first started appearing in the literature almost 30 years ago ({Bartsch:1988vg}). It is an area of research that is increasing in its popularity, a review of the 17 year period between 1989-2006 found 69 studies that utilised biophysical models {Miller:2007iu} and in our own 6 year search from 2010-2015, we discovered 59 studies fitting this criteria (*The full list of references is provided in the SI*). Biophysical models, as the name suggests, produce potential patterns of connectivity using a physical (i.e. oceanographic) model coupled with a biological model. These models are particularly relevant for connectivity in marine systems, as dispersal during a pelagic larval stage is a key driver of connectivity for many species {Cowen:2009fm}. The two models are coupled together, because while oceanic processes are the presiding driver of dispersal, biological processes also have highly influential roles {Leis:2006kf}{Pineda:2007bv}. 

Biophysical models are powerful research tools, allowing us to investigate connectivity patterns over large spatial scales ({Andrello:2013cc}{Treml:2015bt}) and also over long temporal scales ({Richar:2014cg}{Berglund:2012cr}), that are impossible with empirical studies. Another powerful research technique these models provide is the ability to investigate how early-life history traits (e.g. mortality, swimming ability, and orientation) affect the patterns of connectivity studies ({Butler:2011wu}{Staaterman:2012ek}). It allows us to ask important question on connectivity that are hard to replicate *in situ* conditions, due to the inherent difficulties of working with larvae of marine species.

Utilising this large body of biophysical connectivity studies, we conducted a review to evaluate how early-life history traits affected connectivity patterns, in order to understand what to include in our model. We wanted to answer what are the main drivers and consequences of connectivity in marine systems and to understand how important was behaviour. For example, does a longer pelagic larval duration (PLD) increase the size of the dispersal kernel or can a species limit how far they disperse through vertical migration? However, we would argue that this advance in our understanding of marine systems connectivity is being hampered by some drawbacks in the literature, namely 1) inconsistencies in the reporting of response metrics and 2) lack of model and parameter transparency.  In order to assist management, connectivity models need to be implemented with a consistent, methodological approach. In our review we found 54% of studies only implemented passive behaviour, and the other 46% implemented a variety of movement strategies such as ontogenetic vertical migration, diel migration, and horizontal swimming. There does not appear to be a consensus amongst published studies about what early-life history parameters should be implemented. 

##Metrics
Biophysical connectivity studies measure two distinct – yet related – systems, the patterns of connectivity between natal and settlement sites and the dispersal distance of particles in the system. The first is essentially a measure of source-sink dynamics, looking at patterns of production and settlement in marine species. The second is a measure of the total dispersal area, looking at issues such as how far the particles travel and where do they occur in highest densities in the system. In undertaking this review, we came across two impediments to a meta-analysis. Firstly, the hardest issue to overcome was that many studies utilised their own unique metric in measuring either of these patterns. In fact, we found over 30 different measures used to describe the patterns of connectivity & dispersal in these papers. Secondly, often only a single summary statistic was reported, e.g. mean, median, or upper quartile. Summary statistic are useful, however they were often reported without information on the underlying distribution of the dispersal kernel, making comparisons difficult.

In a field where there can be so many different response variables, it is difficult to nail down a core set of metrics to report and reliably compare against. The most common parameters found in the dataset related to distance the particles travelled and measures of self-recruitment, local-retention and settlement success (@tbl:common). This is not as clear cut as it may seem, as there is confusion about the definitions of self-recruitment and local retention, with these terms often used interchangeably or synonymously with other terms such as self-connectivity. {Burgess:2014cf} stated the definitions clearly and succinctly; local retention is the fraction of offspring produced by a population, which also recruits into that population, and self-recruitment is the fraction of recruitment to a site comprised of individuals born in that site.

The de-facto standards for publishing the results of a biophysical connectivity study in our review, was to use a connectivity matrix (also known as a transition matrix) as a measure of connectivity between sites (85%) and a dispersal kernel as a measure of spread (71%). A connectivity matrix is a square matrix with rows representing source sites and columns representing settlement sites. The diagonal of the matrix represents self-recruitment and each column, above and below the diagonal shows where settlers are coming from and where particles are settling too. Connectivity matrices are represented as either the potential connectivity (absolute values) or realised connectivity, which is the potential connectivity, normalised by the number of particles released. The most common metrics reported on from these matrices are self-recruitment (70%), local retention (62%), and dispersal success (42%; @tbl:common). 

A dispersal kernel is a probability distribution function of the particles in the system, which gives you a measure of the distance dispersed in the system. Dispersal kernels are often overlaid on GIS images of the study area, in order to give the reader a better understanding of the spread and concentration of the advected particles. The most common metric reported from the dispersal kernel is distance travelled, however, the summary statistics used vary from mean (57.1%), maximum (33.3%), median (11.9%), upper quartile (11.9%), and the minimum distance travelled (4.8%; @tbl:common). These usefulness statistic will change depending on the distribution of the dispersal kernel, which is shaped by both geographic features and prevailing currents. Though the shape of the distribution needs to be clearly stated along with the summary statistics. Increasing confusion, there were different interpretations of distance travelled; either it was the distance from the origin site to the final site, or the total length of the particles trajectory. There was no consensus on how to report the breadth of the dispersal distance distribution with studies reporting various metrics such as a Dispersion Index ({Pearce:2011fa}), Positive Area ({Andrello:2014ge}), and Isotropy ({Ayata:2010hg}). 

Both connectivity matrices and dispersal kernels are commonly depicted using heat maps, graphical techniques where a  colour system is used to represent numbers. Heat maps are a great visualisation tool for the reader and are to be encouraged, however, it restricts what information which can be extracted from the graph. In general, the range of values depicted are large, and thus they are binned to set of colours, resulting in information loss. Comparative quantitative metrics are essential for analysis between studies, which becomes difficult if the connectivity matrix depicted using a heat map is all that is published as part of the results. Therefore is it imperative for future comparisons that the raw data be published along with the heat maps. 

*Need to include the figures of heat maps and dispersal kernels. WILL: I would make a figure that shows some examples. So it could be a two panel figure where one is a matrix and the other is a dispersal kernel.  You could also include a heat map of the matrix to illustrate the difference in utility.  So maybe a four panel figure for balance.  Where a and b are matrix and heat map and c and d are a few different kernels.  The different kernels could be used to illustrate where reporting something like the mean is useful (when the kernel is normal-sih) and where it isn’t (strongly left or right-skewed).  In the text  you could also highlight the need to report the extremes and there relative commonness.*


##Models and reproducibility
Reproducibility, a term often synonymous with open science, is an important facet in assessing the scientific merit of a published paper. It can be difficult to achieve in large empirical studies due to experimental variance {OpenScienceCollaboration:2015cn}, however, the same challenges do not exist in computational modelling {Peng:2011et}. Ideally for reproducibility, the model configurations, source code and the output data is made available at the time of publishing. Transparency provides both confidence to the reader, and importantly the peer reviewer, about the outcome and interpretations of the study. 

{Sandve:2013gh} produced ten rules of reproducibility for computational research, which all apply to studies involving a biophysical model. Most are intuitive, such as tracking exactly how results were obtained, automating as many steps as possible, and using version control for scripts, code & software. Others are not thought about as often, like recording the seed used for random number generators. The most visible facet to a researcher reading a published study is Rule 10; "all input data, scripts, versions, parameters, and intermediate results should be made publicly and easily accessible" {Sandve:2013gh}. 

Transparency is difficult when performing complex modelling because of all the parameters used. Also, researchers are often familiar with only either the biological or oceanographic model, making it harder to know what parameters are important to publish. In the subset of connectivity studies that we used for the review, there were many common and easily rectifiable omissions that prevented reproducibility, deduced while inspecting the methods and supporting information. 12% of the studies did not mention the years used for their oceanographic model in their simulation. 34% did not mention the time-step used when advecting the particles in their model. 69% mentioned using diffusion in their model, but only 51% of these published the diffusion coefficient used. When mortality was implemented into the biophysical model, 25% of these studies did not include either the mortality curve or rate used.

Complexity in biophysical models derives from coupling two distinct models, biological and physical, creating an additive effect on the number of input parameters.  However, it is impossible to reproduce a biophysical connectivity study without all of these parameters, hence the importance of publishing these parameters along with the results. The strong trend towards supplementary information in journals allows for publication of these parameters without obscuring the primary scientific message. The cost of reproducible research for biophysical studies is minimal, many free online repositories exist for both source code and data, two popular examples being GitHub (http://github.com) and Dryad (http://datadryad.org). Only two studies in the review uploaded their data using such a portal, both choosing to use Dryad. Several journals are also making reproducibility a requirement and providing mechanisms for online storage of data (e.g. PLOS Biology).

*Add the proportion of studies that had enough info to be reproducible into table 3?*

##A common approach 
In order to provide transparency and allow for useful comparisons between connectivity studies using biophysical models, we need a common approach to publishing both methods and results. We identified two main problems in the literature with connectivity studies preventing us from making meaningful comparisons. The first is a lack of commonality of  derived connectivity metrics amongst studies and incomplete reporting of metric values used. The second is the lack of reproducibility and clarity of the model parameters used in studies.

To get consistency amongst metrics, our suggested approach is to utilise the two most common metrics used. These provide useful measures and also they should be readily accepted amongst the research community (@tbl:metrics). The first metric, a connectivity matrix (or transition matrix), is the most useful for connectivity studies. The connectivity measures of self-recruitment, local retention and settlement success can all be calculated simply from the underlying matrix data. Therefore, in addition to presenting the data in a heat map visualisation, the full connectivity matrix should be published. It is suggested these are published in an online data-repository or attached as supplementary information, rather than in the body of the paper. This is especially important where studies may have simulated a number of connectivity matrices for different situations (e.g. time periods, parameter combinations). The supplied matrices can be the summary of your data, e.g. if your study was conducted over a five year period, the matrix can be the mean connectivity over this period. However, if you vary a parameter such as PLD, different matrices should be supplied for each value used.

The second most important metric used to describe the output of these models is the dispersal kernel. The dispersal kernel——a probability density function——gives information about the spread and distance of dispersed the particles in the system. Distance travelled is the most common measure supplied with the dispersal kernel and we suggest providing the mean, median and maximum distance travelled to allow for comparisons between studies, along with the distribution of the dispersal kernel. See [Reference the ICES manual - need to work out how to reference the chapter] for further explanation of these metrics. There is no consensus for a measure used for spread. A couple of studies used a measure called positive or seeded area, which counted all the cells in the system that had greater than one particle to get a measure of spread. Another two studies tried to calculate the centre of the mass of particles to see how it changed over time. The positive area measure holds potential though it would need to be standardised to the size of the cells used in the model.

To provide transparency between studies on how the biophysical model is implemented, we have provided a non-exhaustive list of the sort of parameters required to reproduce these studies (@tbl:open). The list covers parameters used for both the physical and biological models. This is not definitive, models will increasingly become more complex and there will be more parameters added to the initialisation of the models. For reproducible purposes, an individual set of parameter values should be supplied for every model run used in the study. Again, these can be supplied in the supporting information or online in a data repository.

##Conclusion
If we are going to advance our understanding of connectivity in marine systems, biophysical modelling studies need to start publishing consistent quantitative metrics of dispersal and connectivity so that comparisons can be made. In addition, studies need to provide more transparency on the parameters used. We have provided a clear and concise framework to achieve this so we can develop a better understanding of the drivers and outcomes of connectivity.


##Tables

: Those most common metrics published in the connectivity studies and the parameters reported per metric used. {#tbl:common} 

|        Metric       |        Measure parameters        |  Reported(%) |
| ------------------- | ----------------------- | :-------: |
| Connectivity matrix |                         | **84.6** |
|                     | Self-recruitment        | 70.0     |
|                     | Local retention         | 62.0     |
|                     | Dispersal success      | 42.0     |
| Dispersal kernel    |                         | **71.2** |
|                     | Mean distance travelled           | 57.1     |
|                     | Maximum distance travelled        | 33.3     |
|                     | Median distance travelled         | 11.9     |
|                     | Upper quartile distance travelled | 11.9     |
|                     | Minimum distance travelled        | 4.8      |
| Graph theory        |                         | **10.2** |  


: The five measures that are required to make comparative analysis from studies using biophysical connectivity models. {#tbl:metrics} 

|        Metric       | Measure parameters |
| :------------------ | :----------------- |
| Connectivity matrix | Self-recruitment   |
|                     | Local retention    |
|                     | Dispersal success |
| Dispersal kernel    | Mean distance travelled      |
|                     | Median distance travelled      |
|                     | Maximum distance travelled      |
|                     | Spread             |



: List of input parameters to a biophysical model that should be published as part of every connectivity study using a biophysical model. All values should be published in the appropriate SI units where applicable. {#tbl:open}

|   Model    |           Name          |   Description                        |
|------------|-------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Particle   | Particle model          | Link to the source code of the particle model used and specifications with information on type, movement and integration methods e.g. Individual based model, with Lagrangian model and it uses Runge-Kutta fourth order method for integration |
|            | Random number seed                        |   If random numbers are used, it is important to publish the seed used to generate the random number so the study can be replicated {Sandve:2013gh}                                                                                                                                                                                                                                              |
| Physical   | Oceanographic model     | Link to the specifications of the model, including all sub-models, bathymetry & tidal models used                                                                                                                                               |
|            | Spatial scale           | The area the particles can move                                                                                                                                                                                                                 |
|            | Time step               | The time step used to move the particles using the oceanographic model (preferably in seconds)                                                                                                                                                  |
|            | Diffusion / turbulence  | Diffusion strategy (random walk, horizontal and/or vertical) and the turbulence values used                                                                                                                                                     |
| Biological | Release times           | Release times of the particles                                                                                                                                                                                                                  |
|            | Release strategy        | How the particles were released (e.g. daily, lunar, temperature cues, depths)                                                                                                                                                                   |
|            | Release sites           | The GPS locations and sizes of the release sites                                                                                                                                                                                                |
|            | Settlement sites        | The GPS locations and sizes of the settlement sites (if different from the release sites)                                                                                                                                                       |
|            | Particles released      | The number of particles released                                                                                                                                                                        |
|            | Pelagic larval duration | The pelagic larval duration of the taxa and whether you used a variable or fixed duration                                                                                                                                                       |
|            | Pre-competency period   | The pre-competency period given before settlement could occur                                                                                                                                                                                   |
|            | Movement strategies     | What movement strategies were the particles given and the values associated with these strategies (e.g. passive, diel, horizontal)                                                                                                              |
|            | Mortality strategies    | The mortality strategy used (if any)                                                                                                                                                                                                            |
|            | Settlement strategies   | How did the particles choose a settlement site (e.g. passively, sites were buffered 10 kms, sensory cues)


##References




